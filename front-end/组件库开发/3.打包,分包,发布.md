为了支持发布到npm上，我们需要将项目打包成js产物，以便可以直接引入
## 项目打包

### 1. 配置打包文件

我们的项目需要支持cjs/es环境，所以需要分开打包，提升项目的兼容性。
所以在项目的packages/core目录下配置

1. vite.umd.config.ts
	因为不需要处理类型文件，所以直接打包，再通过assetFileNames方法将style.css -> index.css
	```ts
	import { defineConfig } from "vite";
	import { readFile } from "fs";
	import { resolve } from "path";
	import vue from "@vitejs/plugin-vue";

	export default defineConfig({
	  plugins: [
	    vue(),
	  ],
	  build: {
	    outDir: "dist/umd",
	    lib: {
	      entry: resolve(__dirname, "../index.ts"),
	      name: "vElementUI",
	      fileName: "index",
	      formats: ["umd"],
	    },
	    rollupOptions: {
	      external: ["vue"],
	      output: {
	        exports: "named",
	        globals: {
	          vue: "Vue",
	        },
	        assetFileNames: (chunkInfo) => {
	          if (chunkInfo.name === "style.css") {
	            return "index.css";
	          }
	          return chunkInfo.name as string;
	        },
	      },
	    },
	  },
	});
	```
	先将umd环境的打包练习好再说吧
2. vite.es.config.ts
	这里我们有一些特殊的需求：
		- 将类型文件和js/css文件分离，这里需要借助dts插件
		- 我们的组件库不需要用户单独引入组件库，所以在打包过程中就把icon导入，这样会增大组件库的大小，但是是可接受的
		- 
	这里面需要注意的就很多了，首先我们需要安装dts插件，将types文件分离; 之后还需要将icon库导入，
	```ts
	import { defineConfig } from "vite";
import { resolve } from "path";
import vue from "@vitejs/plugin-vue";
import dts from "vite-plugin-dts";

export default defineConfig({
  plugins: [
    vue(),
    dts({
      tsconfigPath: "../../tsconfig.build.json",
      outDir: "dist/types",
    }),
  ],
  build: {
    outDir: "dist/es",
    minify: false,
    cssCodeSplit: true,
    rollupOptions: {
      external: [
        "vue",
        "@fortawesome/fontawesome-svg-core",
        "@fortawesome/free-solid-svg-icons",
        "@fortawesome/vue-fontawesome",
      ],
      output: {
        assetFileNames: (chunkInfo) => {
          if (chunkInfo.name === "style.css") {
            return "index.css";
          }
          if (
            chunkInfo.type === "asset" &&
            /\.(css)$/i.test(chunkInfo.name as string)
          ) {
            return "theme/[name].[ext]";
          }
          return chunkInfo.name as string;
        },

        },
      },
    },
  },
});
	```


### 2.修改package.json中的信息

如果要发布项目到npm上，需要指定一些字段，核心：`name`, `version`, `files`, `main/module/types/exports`

```js
name: 包名，公共发布的话需要唯一
version: 标识版本号
files: 发包物
main: 传统cjs入口
module: esm入口
types: 类型文件
exports: 指定路径，具体可以写成
"exports": {
	".": {
	  "import": "./dist/es/index.es.js",
	  "require": "./dist/umd/index.umd.js",
	  "types": "./dist/types/core/index.d.ts"
	},
	"./dist/": {
	  "import": "./dist/",
	  "require": "./dist/"
	}
}
```

## 3. 发布

需要我们准备好npm账号，之后再命令行中登录即可:

1. `npm login`登录
2. `npm publish --access public`发布公共包，如果包名为@开头，是会自动发私有包的
3. 更新版本
